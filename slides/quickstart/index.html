<!DOCTYPE html>
<html>
  <head>
    <title>Google Slides API Quickstart</title>
    <meta charset='utf-8' />
  </head>
  <body>
    <p>Google Slides API Quickstart</p>
    <button id="authorize_button" style="display: none;">Authorize</button>
    <button id="signout_button" style="display: none;">Sign Out</button>
    <pre id="content"></pre>

    <script>
      // Client ID and API key from the Developer Console
      const CLIENT_ID = '<YOUR_CLIENT_ID>';
      const API_KEY = '<YOUR_API_KEY>';
      // Array of API discovery doc URLs for APIs used by the quickstart
      const DISCOVERY_DOCS = ['https://slides.googleapis.com/$discovery/rest?version=v1'];
      // Authorization scopes required by the API; multiple scopes can be
      // included, separated by spaces.
      const SCOPES = 'https://www.googleapis.com/auth/presentations.readonly';

      const authorizeButton = document.getElementById('authorize_button');
      const signoutButton = document.getElementById('signout_button');

      /**
       *  On load, called to load the auth2 library and API client library.
       */
      function handleClientLoad() {
        gapi.load('client:auth2', () => {
          gapi.client.init({
            clientId: CLIENT_ID,
            apiKey: API_KEY,
            discoveryDocs: DISCOVERY_DOCS,
            scope: SCOPES
          }).then(() => {
            // Listen for sign-in state changes.
            gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);

            // Handle the initial sign-in state.
            updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
            authorizeButton.onclick = () => gapi.auth2.getAuthInstance().signIn();
            signoutButton.onclick = () => gapi.auth2.getAuthInstance().signOut();
          });
        });
      }

      /**
       *  Called when the signed in status changes, to update the UI
       *  appropriately. After a sign-in, the API is called.
       */
      function updateSigninStatus(isSignedIn) {
        if (isSignedIn) listSlides();
        authorizeButton.style.display = (isSignedIn ? 'none' : 'block');
        signoutButton.style.display = (isSignedIn ? 'block' : 'none');
      }

      /**
       * Append a pre element to the body with a message.
       * @param {string} message Text to be placed in pre element.
       */
      function appendPre(message) {
        document.getElementById('content')
          .appendChild(document.createTextNode(message + '\n'));
      }

      /**
       * Prints the number of slides and elements in a sample presentation:
       * https://docs.google.com/presentation/d/1EAYk18WDjIG-zp_0vLm3CsfQh_i8eXc67Jo2O9C6Vuc/edit
       */
      function listSlides() {
        gapi.client.slides.presentations.get({
          presentationId: '1EAYk18WDjIG-zp_0vLm3CsfQh_i8eXc67Jo2O9C6Vuc'
        }).then((response) => {
          const presentation = response.result;
          const length = presentation.slides.length;
          appendPre(`The presentation contains ${length} slides:`);
          presentation.slides.map((slide, i) => {
            appendPre(`- Slide #${(i + 1)} contains ${slide.pageElements.length} elements.`);
          });
        }).catch((response) => {
          appendPre(`Error: ${response.result.error.message}`);
        });
      }
    </script>
    <script async defer src="https://apis.google.com/js/api.js"
      onload="this.onload=function(){};loadClient()"
      onreadystatechange="if (this.readyState === 'complete') this.onload()"></script>
  </body>
</html>
